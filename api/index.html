<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>API Reference - Veil</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "API Reference";
        var mkdocs_page_input_path = "api.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Veil
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Welcome to the Veil Documentation</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">API Reference</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#veil.decorators">decorators</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#veil.decorators.AutologSession">AutologSession</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#veil.decorators.Autologger">Autologger</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#veil.decorators.Autologger.run">run</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#veil.decorators.Autologger.start_session">start_session</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#veil.decorators.MlflowIsolated">MlflowIsolated</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#veil.decorators.MlflowIsolated.__call__">__call__</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#veil.decorators.Run">Run</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#veil.decorators.Run.__call__">__call__</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#veil.types">types</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#veil.types.StringList">StringList</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../usage/">Usage</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Veil</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">API Reference</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="api-reference">API Reference</h1>


<div class="doc doc-object doc-module">



<a id="veil.decorators"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="veil.decorators.AutologSession" class="doc doc-heading">
            <code>AutologSession</code>


</h2>


    <div class="doc doc-contents ">


        <p>Wraps an autolog session.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>autologger</code></b>
                  (<code>Autologger</code>)
              –
              <div class="doc-md-description">
                <p>the autolog object</p>
              </div>
            </li>
            <li>
              <b><code>name</code></b>
                  (<code>Optional[str]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>the experiment name, by default None</p>
              </div>
            </li>
            <li>
              <b><code>log_tags</code></b>
                  (<code>StringDict</code>, default:
                      <code>dict()</code>
)
              –
              <div class="doc-md-description">
                <p>the tags to be logged, by default dict()</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>





              <details class="quote">
                <summary>Source code in <code>veil/decorators.py</code></summary>
                <pre class="highlight"><code class="language-python">class AutologSession:
    """ Wraps an autolog session.

    Parameters
    ----------
    autologger : Autologger
        the autolog object
    name : Optional[str], optional
        the experiment name, by default None
    log_tags : StringDict, optional
        the tags to be logged, by default dict()
    """

    def __init__(
        self,
        autologger: Autologger,
        name: Optional[str] = None,
        log_tags: StringDict = dict(),
    ):
        self.name = name
        self.log_tags = log_tags

        # members with intended private access
        self.__autologger: Autologger = check_type(autologger, Autologger)
        self.__run_id: Optional[str] = None
        self.__past_session: Optional[AutologSession] = None

    @property
    def autologger(self) -&gt; Autologger:
        return self.__autologger

    @property
    def run_id(self) -&gt; Optional[str]:
        return self.__run_id

    @property
    def name(self) -&gt; Optional[str]:
        return self.__name

    @name.setter
    def name(self, value: Optional[str]) -&gt; None:
        self.__name: Optional[str] = check_type(value, Optional[str])

    @property
    def log_tags(self) -&gt; StringDict:
        return self.__log_tags

    @log_tags.setter
    def log_tags(self, value: StringDict) -&gt; None:
        self.__log_tags: StringDict = check_type(value, StringDict)

    def __enter__(self):
        # switch the session currently used by the autologger to this one
        self.__past_session = self.autologger._current_session
        self.autologger._current_session = self

        @MlflowIsolated(autologger=self.autologger)
        def do_enter():
            # starting a session means managing the context so to:
            if self.autologger.is_autolog_enabled:
                # immediately starts and stops a novel parent run associated with this context
                # note that this run will be resumed within run-annotated functions.
                run: ActiveRun = mlflow.start_run(run_name=self.name)
                mlflow.end_run(status=RunStatus.to_string(RunStatus.RUNNING))
                self.__run_id = run.info.run_id

        do_enter()

    def __exit__(self, exc_type, exc_value, exc_tb):

        @MlflowIsolated(autologger=self.autologger)
        def do_exit():
            # terminating a session means managing the context so to:
            if self.autologger.is_autolog_enabled:

                # immediately starts and stops the parent run associated with this context
                # note that it is terminated with a given status, according to exceptions within the
                # context manager.
                termination_status: RunStatus = RunStatus.FINISHED
                if exc_type:
                    termination_status = RunStatus.FAILED
                mlflow.start_run(
                    run_id=self.autologger._current_session.run_id)
                mlflow.end_run(status=RunStatus.to_string(termination_status))
                self.__run_id = None

        do_exit()

        # switch back the session currently used by the autologger to the previous one
        self.autologger._current_session = self.__past_session
        self.__past_session = None</code></pre>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="veil.decorators.Autologger" class="doc doc-heading">
            <code>Autologger</code>


</h2>


    <div class="doc doc-contents ">


        <p>Implements the auto-logging strategy.</p>






              <details class="quote">
                <summary>Source code in <code>veil/decorators.py</code></summary>
                <pre class="highlight"><code class="language-python">class Autologger:
    """ Implements the auto-logging strategy.
    """

    def __init__(
        self,
        is_autolog_enabled: bool = True,
        tracking_uri: str = mlflow.get_tracking_uri(),
        experiment_name: str = Experiment.DEFAULT_EXPERIMENT_NAME,
    ):
        self.is_autolog_enabled = is_autolog_enabled
        self.tracking_uri = tracking_uri
        self.experiment_name = experiment_name

        # members with intended protected access
        self._current_session: Optional[AutologSession] = None

    @property
    def is_autolog_enabled(self) -&gt; bool:
        return self.__is_autolog_enabled

    @is_autolog_enabled.setter
    def is_autolog_enabled(self, value: bool) -&gt; None:
        self.__is_autolog_enabled: bool = check_type(value, bool)

    @property
    def tracking_uri(self) -&gt; str:
        return self.__tracking_uri

    @tracking_uri.setter
    def tracking_uri(self, value: str) -&gt; None:
        self.__tracking_uri: str = check_type(value, str)

    @property
    def experiment_name(self) -&gt; str:
        return self.__experiment_name

    @experiment_name.setter
    def experiment_name(self, value: str) -&gt; None:
        self.__experiment_name: str = check_type(value, str)

    def start_session(
        self,
        name: Optional[str] = None,
        log_tags: StringDict = dict()
    ):
        """Starts a new session.

        Parameters
        ----------
        name : Optional[str], optional
            the experiment name, by default None
        log_tags : StringDict, optional
            the tags to be logged, by default dict()

        Returns
        -------
        AutologSession
            teh autolog session.
        """
        return AutologSession(
            autologger=self,
            name=name,
            log_tags=log_tags
        )

    def run(
        self,
        name: Optional[str] = None,
        log_params: Optional[StringList] = None,
        log_tags: StringDict = dict()
    ):
        """Executes a new run.

        Parameters
        ----------
        name : Optional[str], optional
            the run name, by default None
        log_params : Optional[StringList], optional
            the params to be logged, by default None
        log_tags : StringDict, optional
            the tags to be logged, by default dict()

        Returns
        -------
        Run
            the experiment run.
        """
        return Run(
            autologger=self,
            name=name,
            log_params=log_params,
            log_tags=log_tags
        )</code></pre>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="veil.decorators.Autologger.run" class="doc doc-heading">
            <code class="highlight language-python">run(name=None, log_params=None, log_tags=dict())</code>

</h3>


    <div class="doc doc-contents ">

        <p>Executes a new run.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>name</code></b>
                  (<code>Optional[str]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>the run name, by default None</p>
              </div>
            </li>
            <li>
              <b><code>log_params</code></b>
                  (<code>Optional[StringList]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>the params to be logged, by default None</p>
              </div>
            </li>
            <li>
              <b><code>log_tags</code></b>
                  (<code>StringDict</code>, default:
                      <code>dict()</code>
)
              –
              <div class="doc-md-description">
                <p>the tags to be logged, by default dict()</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>Run</code>
              –
              <div class="doc-md-description">
                <p>the experiment run.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>veil/decorators.py</code></summary>
              <pre class="highlight"><code class="language-python">def run(
    self,
    name: Optional[str] = None,
    log_params: Optional[StringList] = None,
    log_tags: StringDict = dict()
):
    """Executes a new run.

    Parameters
    ----------
    name : Optional[str], optional
        the run name, by default None
    log_params : Optional[StringList], optional
        the params to be logged, by default None
    log_tags : StringDict, optional
        the tags to be logged, by default dict()

    Returns
    -------
    Run
        the experiment run.
    """
    return Run(
        autologger=self,
        name=name,
        log_params=log_params,
        log_tags=log_tags
    )</code></pre>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="veil.decorators.Autologger.start_session" class="doc doc-heading">
            <code class="highlight language-python">start_session(name=None, log_tags=dict())</code>

</h3>


    <div class="doc doc-contents ">

        <p>Starts a new session.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>name</code></b>
                  (<code>Optional[str]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>the experiment name, by default None</p>
              </div>
            </li>
            <li>
              <b><code>log_tags</code></b>
                  (<code>StringDict</code>, default:
                      <code>dict()</code>
)
              –
              <div class="doc-md-description">
                <p>the tags to be logged, by default dict()</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Returns:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
                  <code>AutologSession</code>
              –
              <div class="doc-md-description">
                <p>teh autolog session.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>
            <details class="quote">
              <summary>Source code in <code>veil/decorators.py</code></summary>
              <pre class="highlight"><code class="language-python">def start_session(
    self,
    name: Optional[str] = None,
    log_tags: StringDict = dict()
):
    """Starts a new session.

    Parameters
    ----------
    name : Optional[str], optional
        the experiment name, by default None
    log_tags : StringDict, optional
        the tags to be logged, by default dict()

    Returns
    -------
    AutologSession
        teh autolog session.
    """
    return AutologSession(
        autologger=self,
        name=name,
        log_tags=log_tags
    )</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="veil.decorators.MlflowIsolated" class="doc doc-heading">
            <code>MlflowIsolated</code>


</h2>


    <div class="doc doc-contents ">


        <p>Isolates an Mlflow experiment.</p>






              <details class="quote">
                <summary>Source code in <code>veil/decorators.py</code></summary>
                <pre class="highlight"><code class="language-python">class MlflowIsolated:
    """ Isolates an Mlflow experiment.
    """

    def __init__(
        self,
        autologger: Autologger
    ):
        # members with intended private access
        self.__autologger: Autologger = check_type(autologger, Autologger)

    def __call__(self, func: Callable):
        """
        Execute the decorator as well as the wrapped function
        """
        check_type(func, Callable)

        @functools.wraps(func)
        def isolation_wrapper(*args, **kwargs):
            result: Any = None

            if self.__autologger.is_autolog_enabled and self.__autologger._current_session is not None:

                # 3) switch the run current active run (which is paused) within mlflow with a new one
                past_active_run: ActiveRun = mlflow.active_run()
                if past_active_run:
                    mlflow.end_run(RunStatus.to_string(RunStatus.RUNNING))

                # 1) switch the tracking uri currently used by mlflow to the one in the autologger
                past_tracking_uri: str = mlflow.get_tracking_uri()
                mlflow.set_tracking_uri(self.__autologger.tracking_uri)

                # 2) switch the experiment currently used by mlflow to the one in the autologger
                past_active_experiment_id: str = _active_experiment_id()
                mlflow.set_experiment(
                    experiment_name=self.__autologger.experiment_name)

                # performs the function workload
                result = func(*args, **kwargs)

                # 5) switch back to the previosuly activated experiment
                mlflow.set_experiment(experiment_id=past_active_experiment_id)
                past_active_experiment_id = None

                # 6) switch back to the previously targeted tracking server
                mlflow.set_tracking_uri(past_tracking_uri)
                past_tracking_uri = None

                # 4) switch back to the previously activated run
                if past_active_run:
                    mlflow.start_run(run_id=past_active_run.info.run_id)
                past_active_run = None
            else:
                result = func(*args, **kwargs)

            return result

        return isolation_wrapper</code></pre>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="veil.decorators.MlflowIsolated.__call__" class="doc doc-heading">
            <code class="highlight language-python">__call__(func)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Execute the decorator as well as the wrapped function</p>

            <details class="quote">
              <summary>Source code in <code>veil/decorators.py</code></summary>
              <pre class="highlight"><code class="language-python">def __call__(self, func: Callable):
    """
    Execute the decorator as well as the wrapped function
    """
    check_type(func, Callable)

    @functools.wraps(func)
    def isolation_wrapper(*args, **kwargs):
        result: Any = None

        if self.__autologger.is_autolog_enabled and self.__autologger._current_session is not None:

            # 3) switch the run current active run (which is paused) within mlflow with a new one
            past_active_run: ActiveRun = mlflow.active_run()
            if past_active_run:
                mlflow.end_run(RunStatus.to_string(RunStatus.RUNNING))

            # 1) switch the tracking uri currently used by mlflow to the one in the autologger
            past_tracking_uri: str = mlflow.get_tracking_uri()
            mlflow.set_tracking_uri(self.__autologger.tracking_uri)

            # 2) switch the experiment currently used by mlflow to the one in the autologger
            past_active_experiment_id: str = _active_experiment_id()
            mlflow.set_experiment(
                experiment_name=self.__autologger.experiment_name)

            # performs the function workload
            result = func(*args, **kwargs)

            # 5) switch back to the previosuly activated experiment
            mlflow.set_experiment(experiment_id=past_active_experiment_id)
            past_active_experiment_id = None

            # 6) switch back to the previously targeted tracking server
            mlflow.set_tracking_uri(past_tracking_uri)
            past_tracking_uri = None

            # 4) switch back to the previously activated run
            if past_active_run:
                mlflow.start_run(run_id=past_active_run.info.run_id)
            past_active_run = None
        else:
            result = func(*args, **kwargs)

        return result

    return isolation_wrapper</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="veil.decorators.Run" class="doc doc-heading">
            <code>Run</code>


</h2>


    <div class="doc doc-contents ">


        <p>Encapsulates an Mlflow run with auto-logging features.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>autologger</code></b>
                  (<code>Autologger</code>)
              –
              <div class="doc-md-description">
                <p>the autologger object</p>
              </div>
            </li>
            <li>
              <b><code>name</code></b>
                  (<code>Optional[str]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>the experiment name, by default None</p>
              </div>
            </li>
            <li>
              <b><code>log_params</code></b>
                  (<code>Optional[StringList]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>the params to be logged, by default None</p>
              </div>
            </li>
            <li>
              <b><code>log_tags</code></b>
                  (<code>StringDict</code>, default:
                      <code>dict()</code>
)
              –
              <div class="doc-md-description">
                <p>the tags to be logged, by default dict()</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>





              <details class="quote">
                <summary>Source code in <code>veil/decorators.py</code></summary>
                <pre class="highlight"><code class="language-python">class Run:
    """ Encapsulates an Mlflow run with auto-logging features.

    Parameters
    ----------
    autologger : Autologger
        the autologger object
    name : Optional[str], optional
        the experiment name, by default None
    log_params : Optional[StringList], optional
        the params to be logged, by default None
    log_tags : StringDict, optional
        the tags to be logged, by default dict()
    """

    def __init__(
        self,
        autologger: Autologger,
        name: Optional[str] = None,
        log_params: Optional[StringList] = None,
        log_tags: StringDict = dict(),
    ):
        # members with intended private access
        self.__autologger: Autologger = check_type(autologger, Autologger)
        self.__name: Optional[str] = check_type(name, Optional[str])
        self.__log_params: Optional[StringList] = check_type(
            log_params, Optional[StringList])
        self.__log_tags: StringDict = check_type(log_tags, StringDict)

    @property
    def autologger(self) -&gt; Autologger:
        return self.__autologger

    @property
    def name(self) -&gt; Optional[str]:
        return self.__name

    @property
    def log_params(self) -&gt; Optional[StringList]:
        return self.__log_params

    @property
    def log_tags(self) -&gt; StringDict:
        return self.__log_tags

    def __call__(self, func: Callable):
        """
        Execute the decorator as well as the wrapped function
        """
        check_type(func, Callable)

        @functools.wraps(func)
        @MlflowIsolated(autologger=self.__autologger)
        def wrapper(*args, **kwargs):
            result: Any = None

            if self.__autologger.is_autolog_enabled and self.__autologger._current_session:

                # resume the parent run
                mlflow.start_run(
                    run_id=self.__autologger._current_session.run_id)

                # retrieves the tags from the context
                tags: StringDict = self.__autologger._current_session.log_tags.copy()

                # ...then overrides them with run-bound tags...
                tags.update(self.__log_tags)

                # ...and eventuallly sets mlflow special tags for .git info
                repo_uri, sha_commit, branch_name = _get_repo_info()
                tags.update({
                    MLFLOW_GIT_REPO_URL: repo_uri,
                    MLFLOW_GIT_COMMIT: sha_commit,
                    MLFLOW_GIT_BRANCH: branch_name,
                })

                # uses the user provided run name instead of function name, if any
                _run_name: str = func.__name__
                if not self.__name is None:
                    _run_name = self.__name

                # starts the child run with a context manager (eventually closing it gracefully in case of exceptions)
                with mlflow.start_run(run_name=_run_name, nested=True) as active_run:

                    # then logs tags and...
                    mlflow.set_tags(tags)

                    # ...the params with which the funciton has been called
                    for k, v in kwargs.items():
                        if self.__log_params is not None and len(self.__log_params) &gt; 0:
                            if k in self.log_params:
                                mlflow.log_param(k, v)
                        else:
                            mlflow.log_param(k, v)

                    # finally the function gets invoked
                    result = func(*args, **kwargs)

                # stops the parent run
                mlflow.end_run()

            else:
                result = func(*args, **kwargs)
            return result

        return wrapper</code></pre>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="veil.decorators.Run.__call__" class="doc doc-heading">
            <code class="highlight language-python">__call__(func)</code>

</h3>


    <div class="doc doc-contents ">

        <p>Execute the decorator as well as the wrapped function</p>

            <details class="quote">
              <summary>Source code in <code>veil/decorators.py</code></summary>
              <pre class="highlight"><code class="language-python">def __call__(self, func: Callable):
    """
    Execute the decorator as well as the wrapped function
    """
    check_type(func, Callable)

    @functools.wraps(func)
    @MlflowIsolated(autologger=self.__autologger)
    def wrapper(*args, **kwargs):
        result: Any = None

        if self.__autologger.is_autolog_enabled and self.__autologger._current_session:

            # resume the parent run
            mlflow.start_run(
                run_id=self.__autologger._current_session.run_id)

            # retrieves the tags from the context
            tags: StringDict = self.__autologger._current_session.log_tags.copy()

            # ...then overrides them with run-bound tags...
            tags.update(self.__log_tags)

            # ...and eventuallly sets mlflow special tags for .git info
            repo_uri, sha_commit, branch_name = _get_repo_info()
            tags.update({
                MLFLOW_GIT_REPO_URL: repo_uri,
                MLFLOW_GIT_COMMIT: sha_commit,
                MLFLOW_GIT_BRANCH: branch_name,
            })

            # uses the user provided run name instead of function name, if any
            _run_name: str = func.__name__
            if not self.__name is None:
                _run_name = self.__name

            # starts the child run with a context manager (eventually closing it gracefully in case of exceptions)
            with mlflow.start_run(run_name=_run_name, nested=True) as active_run:

                # then logs tags and...
                mlflow.set_tags(tags)

                # ...the params with which the funciton has been called
                for k, v in kwargs.items():
                    if self.__log_params is not None and len(self.__log_params) &gt; 0:
                        if k in self.log_params:
                            mlflow.log_param(k, v)
                    else:
                        mlflow.log_param(k, v)

                # finally the function gets invoked
                result = func(*args, **kwargs)

            # stops the parent run
            mlflow.end_run()

        else:
            result = func(*args, **kwargs)
        return result

    return wrapper</code></pre>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="veil.types"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="veil.types.StringList" class="doc doc-heading">
            <code class="highlight language-python">StringList = List[str]</code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">

        <p>Type alias for generic dictionaries with string keys and values.</p>
    </div>

</div>





  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href=".." class="btn btn-neutral float-left" title="Welcome to the Veil Documentation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../usage/" class="btn btn-neutral float-right" title="Usage">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href=".." style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../usage/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
